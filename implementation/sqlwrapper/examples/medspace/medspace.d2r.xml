<?xml version="1.0"?>
<!-->Map specifies wraps the D2R mapping<-->
<d2r:Map xmlns:d2r="http://www.medspace.com/D2Rmap"
>

	<!-->DBConnection holds information for connecting to the database
	jdbcDriver="com.mysql.jdbc.Driver"
	jdbcDSN="jdbc:mysql://localhost:3306/medspace?useSSL=false"

	
	org.h2.Driver
	jdbc:h2:tcp://localhost:5000/./medspace;SCHEMA=MEDSPACE
	<-->
	
	<!-- -->
	<d2r:DBConnection
			jdbcDriver="com.mysql.jdbc.Driver"
			jdbcDSN="jdbc:mysql://localhost:3306/medspace?useSSL=false"
			maxConnections="10"
	>
		<!-->DBAuthentification is used to authenticate in the database with username and password<-->
		<d2r:DBAuthentification username="medspace_client" password="k4N!rT"/>

		<!--database specific properties-->
		<d2r:DataSourceProperty name="cachePrepStmts" value="true"/>
		<d2r:DataSourceProperty name="prepStmtCacheSize" value="250"/>
		<d2r:DataSourceProperty name="prepStmtCacheSqlLimit" value="2048"/>
		<d2r:DataSourceProperty name="useServerPrepStmts" value="true"/>
		<d2r:DataSourceProperty name="useLocalSessionState" value="true"/>
		<d2r:DataSourceProperty name="useLocalTransactionState" value="true"/>
		<d2r:DataSourceProperty name="rewriteBatchedStatements" value="true"/>
		<d2r:DataSourceProperty name="cacheResultSetMetadata" value="true"/>
		<d2r:DataSourceProperty name="cacheServerConfiguration" value="true"/>
		<d2r:DataSourceProperty name="elideSetAutoCommits" value="true"/>
		<d2r:DataSourceProperty name="maintainTimeStats" value="false"/>
	</d2r:DBConnection>

	<!-->Which rdf serialization language should be used?
		For more information about the supported rdf formats see:
		https://jena.apache.org/documentation/io/streaming-io.html#rdfformat-and-lang
	<-->
	<d2r:OutputFormat>TURTLE</d2r:OutputFormat>

	<!-->Specifies where the wrapper should store indexed data

	<-->
	<d2r:Index directory="_work/medspace/index"/>

	<!-->RDF namespaces
		@attribute prefix:		The prefix to use in the rdf triples
		@attribute namespace:	The namespace represented by the prefix
	<-->
	<d2r:Namespace prefix="test" namespace="http://localhost/patient_test_namespace#"/>
	<d2r:Namespace prefix="owl" namespace="http://www.w3.org/2002/07/owl#"/>
	<d2r:Namespace prefix="rdf" namespace="http://www.w3.org/1999/02/22-rdf-syntax-ns#"/>
	<d2r:Namespace prefix="dc" namespace="http://purl.org/dc/elements/1.1/"/>
	<d2r:Namespace prefix="xsd" namespace="http://www.w3.org/2001/XMLSchema#"/>
	<d2r:Namespace prefix="language" namespace="http://localhost/patient_test_namespace/languages#"/>
	<d2r:Namespace prefix="maritalStatus" namespace="http://localhost/patient_test_namespace/maritalstatus#"/>
	<d2r:Namespace prefix="sex" namespace="http://localhost/patient_test_namespace/sex#"/>
	<d2r:Namespace prefix="patient" namespace="http://localhost/patient_test_namespace/patient#"/>


	<d2r:ClassMap 
		type="test:language"
		sql="SELECT * FROM language;"
		baseURI="http://localhost/patient_test_namespace/languages#"
		resourceIdColumns="language.name"
		id="language">
		
		<d2r:DataTypePropertyBridge property="test:languageName" pattern="@@language.name@@" dataType="rdf:langString" lang="en"/>
	</d2r:ClassMap>

	<d2r:ClassMap
			sql="SELECT m.name AS hello FROM maritalstatus m;"
			resourceIdColumns="m.name"
			baseURI="http://localhost/patient_test_namespace/maritalstatus#"
			type="test:maritalstatus"
			id="maritalstatus"
	>
		<!--> Aliases can be used in the pattern attribute<-->
		<!--> m is an alias for maritalstatuc; So m.name refers to maritalstatus.name <-->
		<d2r:DataTypePropertyBridge property="test:maritalStatusName" pattern="@@m.name@@" dataType="xsd:string"/>
	</d2r:ClassMap>

	<d2r:ClassMap
			sql="SELECT * FROM sex;"
			resourceIdColumns="sex.name"
			baseURI="http://localhost/patient_test_namespace/sex#"
			type="test:sex"
			id="sex"
	>
		<d2r:DataTypePropertyBridge property="test:sexName" pattern="@@sex.name@@" dataType="xsd:string"/>
	</d2r:ClassMap>

	<d2r:ClassMap
			sql="SELECT p.id, p.dateOfBirth, p.sex, p.maritalstatus, p.language FROM patient p;"
			resourceIdColumns="patient.id"
			baseURI="http://localhost/patient_test_namespace/patient#"
			id="patient"
			type="test:patient"
	>
		<d2r:DataTypePropertyBridge property="test:patientID" pattern="@@patient.id@@" dataType="xsd:string"/>
		<d2r:DataTypePropertyBridge property="test:date" pattern="@@patient.dateOfBirth@@" dataType="xsd:date"/>
		<d2r:ObjectPropertyBridge property="test:sex" referredClass="sex" referredColumns="patient.sex"/>
		<d2r:ObjectPropertyBridge property="test:maritalstatus" referredClass="maritalstatus"
								  referredColumns="patient.maritalstatus"/>
		<d2r:ObjectPropertyBridge property="test:maritalstatus" pattern="maritalStatus:@@patient.maritalstatus@@"/>
		<d2r:ObjectPropertyBridge property="test:language" referredClass="language" referredColumns="patient.language"/>
	</d2r:ClassMap>
</d2r:Map>